-- MySQL Script generated by MySQL Workbench
-- Thu Jul 19 23:44:29 2018
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema javaee_ecommerce
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema javaee_ecommerce
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `javaee_ecommerce` DEFAULT CHARACTER SET utf8 ;
USE `javaee_ecommerce` ;

-- -----------------------------------------------------
-- Table `javaee_ecommerce`.`categoria`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `javaee_ecommerce`.`categoria` (
  `idcat` INT NOT NULL AUTO_INCREMENT,
  `nom_cat` VARCHAR(50) NOT NULL,
  `est_cat` TINYINT(1) NOT NULL DEFAULT 1,
  `catsup_cat` INT NOT NULL,
  PRIMARY KEY (`idcat`),
  UNIQUE INDEX `nom_cat_UNIQUE` (`nom_cat` ASC),
  INDEX `fk_categoria_categoria_idx` (`catsup_cat` ASC),
  CONSTRAINT `fk_categoria_categoria`
    FOREIGN KEY (`catsup_cat`)
    REFERENCES `javaee_ecommerce`.`categoria` (`idcat`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `javaee_ecommerce`.`marca`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `javaee_ecommerce`.`marca` (
  `idmar` INT NOT NULL AUTO_INCREMENT,
  `nom_mar` VARCHAR(50) NOT NULL,
  `est_mar` TINYINT(1) NOT NULL DEFAULT 1,
  PRIMARY KEY (`idmar`),
  UNIQUE INDEX `nom_mar_UNIQUE` (`nom_mar` ASC))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `javaee_ecommerce`.`producto`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `javaee_ecommerce`.`producto` (
  `idpro` INT NOT NULL,
  `idcat` INT NOT NULL,
  `idmar` INT NOT NULL,
  `nom_pro` VARCHAR(50) NOT NULL,
  `des_pro` VARCHAR(250) NOT NULL,
  `pre_pro` DECIMAL(19,2) NOT NULL,
  `prenue_pro` DECIMAL(19,2) NOT NULL,
  `sto_pro` INT NOT NULL,
  `nue_pro` TINYINT(1) NOT NULL DEFAULT 1,
  `rec_pro` TINYINT(1) NOT NULL DEFAULT 0,
  `est_pro` TINYINT(1) NOT NULL DEFAULT 1,
  `img_pro` VARCHAR(50) NOT NULL DEFAULT 'demo.png',
  PRIMARY KEY (`idpro`),
  UNIQUE INDEX `nom_pro_UNIQUE` (`nom_pro` ASC),
  INDEX `fk_producto_categoria_idx` (`idcat` ASC),
  INDEX `fk_producto_marc_idx` (`idmar` ASC),
  CONSTRAINT `fk_producto_categoria`
    FOREIGN KEY (`idcat`)
    REFERENCES `javaee_ecommerce`.`categoria` (`idcat`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_producto_marca`
    FOREIGN KEY (`idmar`)
    REFERENCES `javaee_ecommerce`.`marca` (`idmar`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `javaee_ecommerce`.`revision`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `javaee_ecommerce`.`revision` (
  `idrev` INT NOT NULL AUTO_INCREMENT,
  `idpro` INT NOT NULL,
  `nom_rev` VARCHAR(50) NOT NULL,
  `cor_rev` VARCHAR(50) NOT NULL,
  `com_rev` VARCHAR(250) NOT NULL,
  `est_rev` INT NOT NULL DEFAULT 3,
  `fec_rev` DATETIME NOT NULL,
  PRIMARY KEY (`idrev`),
  INDEX `fk_revision_producto_idx` (`idpro` ASC),
  CONSTRAINT `fk_revision_producto`
    FOREIGN KEY (`idpro`)
    REFERENCES `javaee_ecommerce`.`producto` (`idpro`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `javaee_ecommerce`.`moneda`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `javaee_ecommerce`.`moneda` (
  `nom_mon` VARCHAR(3) NOT NULL,
  `idpro` INT NOT NULL,
  `pre_pro` DECIMAL(19,2) NOT NULL,
  `prenue_pro` DECIMAL(19,2) NOT NULL,
  PRIMARY KEY (`nom_mon`, `idpro`),
  INDEX `fk_moneda_producto_idx` (`idpro` ASC),
  CONSTRAINT `fk_moneda_producto`
    FOREIGN KEY (`idpro`)
    REFERENCES `javaee_ecommerce`.`producto` (`idpro`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
